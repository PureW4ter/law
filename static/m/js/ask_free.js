define('ask_free',["component/header","ajaxhelper","utility"],function(e,t,n){var r={ipropertis:null,idIndex:0,initialize:function(){this.mainBox=$("#i_mainbox"),this.tplfun=_.template($("#i_tpl").html()),this._sendRequest()},_sendRequest:function(){var e={};t.get("http://"+window.frontJSHost+"/ask/props",e,this,this._render,null)},_render:function(e){this.propertis=e,this.mainBox.html(this.tplfun({result:e})),this._registEvent()},_registEvent:function(){$("#i_pay").off("click",this._pay).on("click",{ctx:this},this._pay),$("#i_identity").off("change",this._changeIdentity).on("change",{ctx:this},this._changeIdentity)},_changeIdentity:function(e){var t=$(e.target).find("option").not(function(){return!this.selected}).val();e.data.ctx.idIndex=t,$("#i_trade_phase").find("option").remove(),e.data.ctx.propertis.r[2][t].phases.forEach(function(e,t){$("#i_trade_phase").append("<option value='"+t+"'>"+e.phase+"</option>")}),e.data.ctx._registEvent()},_pay:function(e){var r={userId:n.getUserId(),productId:$("#i_product").data("id"),role:$("#i_identity option").not(function(){return!this.selected}).text(),tradePhase:$("#i_trade_phase option").not(function(){return!this.selected}).text(),memo:$("#i_memo").val()};t.post("http://"+window.frontJSHost+"/order/screate",r,this,function(e){var n={id:e.r.id};t.get("http://"+window.frontJSHost+"/order/pay",n,this,function(e){window.location="success.html"})})}};return r});
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
    <link href="styles/main.css" rel="stylesheet" />
    <title>一站咨询</title>
</head>
<body>
    <div id="i_main">
        <!-- header -->
        <div id="i_headbox">
        </div>
        <!--body-->
        <div id="i_mainbox">
            <script type="text/template" id="i_tpl">
            <div>
                <img src="img/index_banner.jpg">
                <div class="phone_icon">
                    <img src="img/phone.png">
                </div>
            </div>
            <div style="position:relative">
                <div class="new_input_section">
                    <div class="new_input_box arrow_down">
                        <label>您的身份</label>
                        <select id="i_identity">
                            <%_.each(result.r[2],function(item, index){%>
                            <option value="<%=index%>"><%=item.role%></option>
                            <%})%>
                        </select>
                    </div>
                    <div class="blk10"></div>
                    <div class="new_input_box arrow_down">
                        <label>目前所处的交易阶段</label>
                        <select id="i_trade_phase">
                             <%_.each(result.r[2][0].phases,function(item, index){%>
                                <option value="<%=index%>"><%=item.phase%></option>
                            <%})%>
                        </select>
                    </div>
                    <div class="blk10"></div>
                    <div class="new_input_box arrow_down">
                        <label>问题类型</label>
                        <select id="i_question_types">
                             <%_.each(result.r[2][0].phases[0].subPhases,function(item, index){%>
                                <option value="<%=index%>"><%=item.phase%></option>
                            <%})%>
                        </select>
                    </div>
                    <div class="blk10"></div>
                    <div class="input_upper">
                        上传合同文本，可以帮助律师做出准确判断
                    </div>
                    <div class="new_input_box arrow_down">
                        <label>我已经签署了</label>
                        <select id="i_sign">
                            <%_.each(result.r[1],function(item){%>
                            <option value="<%=item.id%>"><%=item.name%></option>
                            <%})%>
                        </select>
                    </div>
                    <div class="input_bottom">
                        提示：根据选择的合同类型做提示说明
                    </div>
                    <div class="quesiton_count_title">提交后进入回复倒计时</div>
                    <div class="question_pay" id="i_pay_way">
                        <ul>
                            <li class="question_pay_selected j_tab" data-id="<%=result.r[3][1].id%>">
                                <div class="question_pay_box">
                                    <div class="question_pay_title1">2小时内电话回复</div>
                                    <div class="question_pay_title2">24小时内书面回复</div>
                                    <div class="question_pay_title3">¥<%=result.r[3][1].price%></div>
                                </div>
                            </li>
                            <li class="j_tab" data-id="<%=result.r[3][0].id%>">
                                <div class="question_pay_box">
                                    <div class="question_pay_title1">24小时内书面回复</div>
                                    <div class="question_pay_title2">&nbsp;</div>
                                    <div class="question_pay_title3">¥<%=result.r[3][0].price%></div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="blk10"></div>
                    <div class="pay_btn" id="i_pay">去支付</div>
                    <div class="blk15"></div>
                </div>
            </div>
            </script>
        </div>
    </div>
</body>
<script src="js/lib/jweixin-1.0.0.js"></script>
<script src="js/lib/lib.js?ver=20170603143236" type="text/javascript"></script>
<script type="text/javascript">
    define('ask_pay',["component/header","ajaxhelper","utility"],function(e,t,n){var r={propertis:null,idIndex:0,initialize:function(){this.mainBox=$("#i_mainbox"),this.tplfun=_.template($("#i_tpl").html()),this._sendRequest()},_sendRequest:function(){var e={};t.get("http://"+window.frontJSHost+"/ask/props",e,this,this._render,null)},_render:function(e){this.propertis=e,this.mainBox.html(this.tplfun({result:e})),this._registEvent()},_registEvent:function(){$("#i_pay").off("click",this._pay).on("click",{ctx:this},this._pay),$("#i_question_types li").off("click",this._chooseType).on("click",{ctx:this},this._chooseType),$("#i_identity").off("change",this._changeIdentity).on("change",{ctx:this},this._changeIdentity),$("#i_trade_phase").off("change",this._changePhase).on("change",{ctx:this},this._changePhase),$("#i_pay_way li").off("click",this._selectPayWay).on("click",{ctx:this},this._selectPayWay)},_changeIdentity:function(e){var t=$(e.target).find("option").not(function(){return!this.selected}).val();e.data.ctx.idIndex=t,$("#i_trade_phase").find("option").remove(),e.data.ctx.propertis.r[2][t].phases.forEach(function(e,t){$("#i_trade_phase").append("<option value='"+t+"'>"+e.phase+"</option>")}),$("#i_question_types").find("option").remove(),e.data.ctx.propertis.r[2][t].phases[0].subPhases.forEach(function(e,t){$("#i_question_types").append("<option>"+e.phase+"</option>")}),e.data.ctx._registEvent()},_changePhase:function(e){var t=$(e.target).find("option").not(function(){return!this.selected}).val();$("#i_question_types").find("option").remove(),e.data.ctx.propertis.r[2][e.data.ctx.idIndex].phases[t].subPhases.forEach(function(e,t){$("#i_question_types").append("<option>"+e.phase+"</option>")}),e.data.ctx._registEvent()},_pay:function(e){var r={userId:n.getUserId(),productId:$($(".question_pay_selected")[0]).data("id"),role:$("#i_identity option").not(function(){return!this.selected}).text(),tradePhase:$("#i_trade_phase option").not(function(){return!this.selected}).text(),tradeSubphase:$("#i_question_types option").not(function(){return!this.selected}).text(),sn:$("#i_sign option").not(function(){return!this.selected}).text()};t.post("http://"+window.frontJSHost+"/order/screate",r,this,function(e){var r={id:e.r.id};t.get("http://"+window.frontJSHost+"/order/pay",r,this,function(){n.showToast("支付成功"),window.location="question_complete.html?id="+e.r.id})})},_selectPayWay:function(e){$(".j_tab").removeClass("question_pay_selected"),$(e.currentTarget).addClass("question_pay_selected")},_chooseType:function(e){$(e.currentTarget).addClass("subPhase_selected")}};return r});
</script>
</html>

define(["component/header","ajaxhelper","utility","component/time_button"],function(e,t,n,r){var i={initialize:function(){this.mainBox=$("#i_mainbox"),this.logontplfun=_.template($("#i_login_tpl").html()),this._sendRequest()},_sendRequest:function(e){this._render()},_render:function(e){this.mainBox.html(this.logontplfun()),r.initialize("i_getcode_btn"),this._registEvent()},_registEvent:function(){$("[data-toggle='popover']").bind({focus:p_destroy,blur:input_check}),$(".submit").off("click",this.subIt).on("click",{ctx:this},this.subIt),r.registBtnEvent(this.getCode)},getCode:function(){var e=$("#i_phone").val();if(!e){n.showToast("请先输入手机号码");return}var i={phoneNum:e};t.get("http://"+window.frontJSHost+"/api/ssm/code",i,this,function(){}),r.startCount()},subIt:function(e){var r=n.getFormValues("loginIt");$("input").blur(),$(".popover.in").length<1&&t.get("http://"+window.frontJSHost+"/api/user/login",r,e.data.ctx,e.data.ctx.success,null)},bindEnter:function(e){e.keyCode==13&&(e.preventDefault(),e.data.ctx.subIt(e))},success:function(e){e.expires_time=(new Date).getTime()+36e5,window.localStorage.setItem("userInfo",JSON.stringify(e.r)),window.location="user_management.html"}};return i});
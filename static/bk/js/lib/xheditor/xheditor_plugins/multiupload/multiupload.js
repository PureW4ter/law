/*!
 * MultiUpload for xheditor
 * @requires xhEditor
 * 
 * @author Yanis.Wang<yanis.wang@gmail.com>
 * @site http://xheditor.com/
 * @licence LGPL(http://www.opensource.org/licenses/lgpl-license.php)
 * 
 * @Version: 0.9.2 (build 100505)
 */

function removeFile(){var e;if(!selectID)return;for(var t in selQueue){e=selQueue[t];if(e.id==selectID){selQueue.splice(t,1),allSize-=e.size,swfu.cancelUpload(e.id),$("#"+e.id).remove(),selectID=null;break}}$("#btnClear").hide(),selQueue.length==0&&$("#controlBtns").hide()}function startUploadFiles(){swfu.getStats().files_queued>0?($("#controlBtns").hide(),swfu.startUpload()):alert("‰∏ä‰º†ÂâçËØ∑ÂÖàÊ∑ªÂä†Êñá‰ª?")}function setFileState(e,t){$("#"+e+"_state").text(t)}function fileQueued(e){for(var t in selQueue)if(selQueue[t].name==e.name)return swfu.cancelUpload(e.id),!1;selQueue.length==0&&$("#controlBtns").show(),selQueue.push(e),allSize+=e.size,$("#listBody").append('<tr id="'+e.id+'"><td>'+e.name+"</td><td>"+formatBytes(e.size)+'</td><td id="'+e.id+'_state">Â∞±Áª™</td></tr>'),$("#"+e.id).hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}).click(function(){selectID=e.id,$("#listBody tr").removeClass("select"),$(this).removeClass("hover").addClass("select"),$("#btnClear").show()})}function fileQueueError(e,t,n){var r="";switch(t){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:r="Âè™ËÉΩÂêåÊó∂‰∏ä‰º† "+this.settings.file_upload_limit+" ‰∏™Êñá‰ª?";break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:r="ÈÄâÊã©ÁöÑÊñá‰ª∂Ë∂ÖËøá‰∫ÜÂΩìÂâçÂ§ßÂ∞èÈôêÂà∂Ôº?"+this.settings.file_size_limit;break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:r="Èõ∂Â§ßÂ∞èÊñá‰ª?";break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:r="Êñá‰ª∂Êâ©Â±ïÂêçÂøÖÈú?‰∏∫Ôºö"+this.settings.file_types_description+" ("+this.settings.file_types+")";break;default:r="Êú™Áü•ÈîôËØØ"}alert(r)}function uploadStart(e){setFileState(e.id,"‰∏ä‰º†‰∏≠‚??")}function uploadProgress(e,t,n){var r=Math.ceil((uploadSize+t)/allSize*100);$("#progressBar span").text(r+"% ("+formatBytes(uploadSize+t)+" / "+formatBytes(allSize)+")"),$("#progressBar div").css("width",r+"%")}function uploadSuccess(file,serverData){var data=Object;try{eval("data="+serverData)}catch(ex){}data.err!=undefined&&data.msg!=undefined?data.err?(setFileState(file.id,"‰∏ä‰º†Â§±Ë¥•"),alert(data.err)):(uploadSize+=file.size,arrMsg.push(data.msg),setFileState(file.id,"‰∏ä‰º†ÊàêÂäü")):setFileState(file.id,"‰∏ä‰º†Â§±Ë¥•Ôº?")}function uploadError(e,t,n){setFileState(e.id,"‰∏ä‰º†Â§±Ë¥•Ôº?")}function uploadComplete(e){swfu.getStats().files_queued>0?swfu.startUpload():uploadAllComplete()}function uploadAllComplete(){callback(arrMsg)}function formatBytes(e){var t=["Byte","KB","MB","GB","TB","PB"],n=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(n))).toFixed(2)+" "+t[n]}var swfu,selQueue=[],selectID,arrMsg=[],allSize=0,uploadSize=0;
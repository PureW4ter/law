define(["component/nav_bar","component/header","ajaxhelper","utility"],function(e,t,n,r){var i={lawyerId:"",initialize:function(){e.initialize("i_navbar",4),t.initialize("i_header","律师管理"),this.lawyerId=r.getQueryParameter("id"),this.mainBox=$("#i_mainbox"),this.tplFun=_.template($("#i_tpl").html()),this._sendRequest()},_sendRequest:function(){if(!this.lawyerId)this._render({});else{var e={id:this.lawyerId};n.get("http://"+window.frontJSHost+"/api/lawyer/detail",e,this,this._render,null)}},_render:function(e){if(e.r)for(var t in r.cities)r.cities[t].id==e.r.cityId&&(e.r.cityName=r.cities[t].name);this.mainBox.html(this.tplFun({result:e,cities:r.cities})),this._registEvent()},_registEvent:function(){$("#i_selAuth li").off("click",this._sel).on("click",{ctx:this},this._sel),$("#i_city li").off("click",this._sel).on("click",{ctx:this},this._sel),$("#i_save_btn").off("click",this._doSave).on("click",{ctx:this},this._doSave),$("#i_cancel_btn").off("click",this._doCancel).on("click",{ctx:this},this._doCancel),$("[data-toggle='popover']").off({focus:p_destroy,checkis:input_check}).on({focus:p_destroy,checkis:input_check})},_sel:function(e){var t=$(this).data("value"),n=$(this).text();$(this).closest("ul").parents(".btn-group").data("value",t).find("button").eq(0).text(n)},_doSave:function(e){var t=$("#i_typeForm");$("input,textarea").trigger("checkis");if($(".popover.in").length<1){var i={};i.name=$("#i_name").val(),i.loginName=$("#i_login_name").val(),i.password=$("#i_login_password").val(),i.phoneNum=$("#i_phone").val(),i.cityId=$("#i_city").data("value"),i.memo=$("#i_memo").val(),e.data.ctx.lawyerId?(i.id=e.data.ctx.lawyerId,n.post("http://"+window.frontJSHost+"/api/lawyer/create",i,e.data.ctx,function(){r.showToast("更新成功！",function(){window.location="lawyer_management.html"})})):n.post("http://"+window.frontJSHost+"/api/lawyer/create",i,e.data.ctx,function(){r.showToast("保存成功！",function(){window.location="lawyer_management.html"})})}},_doCancel:function(e){window.location="lawyer_management.html"}};return i});
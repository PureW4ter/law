define(["component/nav_bar","component/header","ajaxhelper","utility"],function(e,t,n,r){var i={initialize:function(){e.initialize("i_navbar",6),t.initialize("i_header","调查订单管理"),this.mainBox=$("#i_mainbox"),this.tplFun=_.template($("#i_tpl").html()),this.modalBox=$("#i_modal_body"),this.modalTplFun=_.template($("#i_modal_tpl").html()),this._sendRequest()},_sendRequest:function(){var e={page:0,size:20};n.get("http://"+window.frontJSHost+"/api/order/slist",e,this,this._render,null)},_render:function(e){this.mainBox.html(this.tplFun({result:e})),this._registEvent()},_registEvent:function(){$("#i_search").off("click",this._doSearch).on("click",{ctx:this},this._doSearch),$("#i_filter").off("click",this._doFilter).on("click",{ctx:this},this._doFilter),$(".j_assign").off("click",this._assign).on("click",{ctx:this},this._assign),$(".j_do_assign").off("click",this._doAssign).on("click",{ctx:this},this._doAssign),$("#i_order_filter li").off("click",this._selProductCode).on("click",{ctx:this},this._selProductCode)},_selProductCode:function(e){var t=$(this).data("value"),n=$(this).text(),r=$($(this).parents("tr")).data("id");$(this).closest("ul").prev("button").data("value",t).find("span").eq(0).text(n)},_assign:function(e){var t={cityId:$(e.currentTarget).data("city")},r=$(e.currentTarget).parents("tr").data("id");n.get("http://"+window.frontJSHost+"/api/lawyer/listbycity",t,e.data.ctx,function(e){$("#i_modal").data({id:r}).modal("show"),this.modalBox.html(this.modalTplFun({result:e})),this._registEvent()},null)},_doAssign:function(e){var t=$("#i_modal").data("id"),i=$(e.currentTarget).parents("tr").data("id"),s={opId:r.getUserId(),lawyerId:i,orderId:t};$("#i_modal").modal("hide"),n.get("http://"+window.frontJSHost+"/api/order/assignment",s,e.data.ctx,function(e){r.showToast("指派成功"),this._sendRequest()},null)},_doSearch:function(e){var t=$("#i_order_search").val(),r={};n.get("http://"+window.frontJSHost+"/api/order/"+t,r,e.data.ctx,e.data.ctx._render,null)},_doFilter:function(e){var t=$("#i_pd_value").data("value"),r={productCode:t,page:0,size:20};t?n.get("http://"+window.frontJSHost+"/api/order/listbytype",r,e.data.ctx,e.data.ctx._render):n.get("http://"+window.frontJSHost+"/api/order/slist",r,e.data.ctx,e.data.ctx._render)}};return i});